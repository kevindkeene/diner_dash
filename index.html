<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Catch-22: 4K Ultra Landscape</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800;900&family=Bungee&display=swap');
        
        :root {
            /* 1 gu = 1% of container width. Maintains 16:9 scaling. */
            --gu: min(1vw, 1.77vh); 
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #000; 
            color: #f9fafb; 
            margin: 0; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            height: 100dvh; 
            width: 100vw; 
            overflow: hidden; 
            user-select: none;
            touch-action: none;
        }

        #game-container {
            position: relative;
            width: min(100vw, calc(100vh * (16 / 9)));
            height: min(100vh, calc(100vw * (9 / 16)));
            display: flex;
            flex-direction: column;
            background: #000;
            overflow: hidden;
        }

        #game-area {
            position: relative;
            width: 100%;
            flex-grow: 1;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            overflow: hidden;
            touch-action: none; 
        }

        /* --- UI OVERLAY SYSTEM --- */
        .game-status-overlay {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex; 
            flex-direction: column;
            align-items: center; 
            z-index: 300;
            pointer-events: none;
        }

        .overlay-dark {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            justify-content: center !important; 
            pointer-events: auto;
        }

        /* --- ROAD AREA POSITIONING --- */
        .road-stack {
            /* Set to exactly 33 units as requested for optimal road placement */
            margin-top: calc(var(--gu) * 33); 
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .reg-container {
            width: 85%;
            max-width: calc(var(--gu) * 60);
            display: flex;
            flex-direction: column;
            gap: calc(var(--gu) * 1);
        }

        .expo-header {
            margin-bottom: calc(var(--gu) * 0.8);
            text-align: center;
            font-size: calc(var(--gu) * 1.8);
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.5em;
            color: #ffbf47;
            line-height: 1;
        }

        .leaderboard-card {
            background: rgba(15, 15, 15, 1);
            padding: calc(var(--gu) * 1) calc(var(--gu) * 3);
            border-radius: calc(var(--gu) * 1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 85%;
            max-width: calc(var(--gu) * 85);
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .lb-rank { font-size: calc(var(--gu) * 4); color: #9180ff; font-family: 'Bungee', cursive; margin-right: calc(var(--gu) * 2.5); }
        .lb-name { font-size: calc(var(--gu) * 2.8); font-weight: 900; text-transform: uppercase; color: #fff; line-height: 1; }
        .lb-company { font-size: calc(var(--gu) * 1); font-weight: 700; color: #6b7280; text-transform: uppercase; letter-spacing: 0.15em; margin-top: calc(var(--gu) * 0.2); }
        .lb-score { font-size: calc(var(--gu) * 5); font-weight: 900; color: #9180ff; font-family: monospace; }

        .btn-pill {
            padding: calc(var(--gu) * 0.7) calc(var(--gu) * 6);
            border-radius: calc(var(--gu) * 3);
            font-weight: 900;
            text-transform: uppercase;
            transition: transform 0.1s;
            cursor: pointer;
            pointer-events: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            color: #000;
            font-size: calc(var(--gu) * 1.6);
            border: none;
            margin-top: calc(var(--gu) * 1.2);
            box-shadow: 0 5px 20px rgba(0,0,0,0.6);
        }
        .btn-pill:active { transform: scale(0.95); }

        /* --- UI ELEMENTS --- */
        .countdown-text { font-size: calc(var(--gu) * 12); font-family: 'Bungee', cursive; color: #fff; text-shadow: 0 0 30px rgba(255,255,255,0.4); line-height: 1; }
        .go-title { font-size: calc(var(--gu) * 6); font-family: 'Bungee', cursive; color: #ef4444; font-style: italic; line-height: 1; text-align: center; }
        .go-score { font-size: calc(var(--gu) * 5.5); font-weight: 900; color: #ffbf47; font-family: monospace; margin-top: calc(var(--gu) * 0.3); }
        .go-sub { font-size: calc(var(--gu) * 1); font-weight: 900; text-transform: uppercase; letter-spacing: 0.4em; opacity: 0.4; }

        /* --- FORM STYLING --- */
        .reg-label { display: block; text-transform: uppercase; font-weight: 900; letter-spacing: 0.2em; color: #ffbf47; margin-bottom: calc(var(--gu) * 0.3); font-size: calc(var(--gu) * 1); }
        .form-input {
            background: rgba(255,255,255,0.05);
            border: calc(var(--gu) * 0.2) solid rgba(255,255,255,0.1);
            padding: calc(var(--gu) * 0.8) calc(var(--gu) * 1.2);
            border-radius: calc(var(--gu) * 0.8);
            color: white;
            font-size: calc(var(--gu) * 1.5);
            width: 100%;
            outline: none;
            margin-bottom: calc(var(--gu) * 0.8);
        }
        .form-input:focus { border-color: #ffbf47; }

        /* --- HUD --- */
        #hud { background-color: #020617; border-bottom: calc(var(--gu) * 0.4) solid #1e293b; padding: calc(var(--gu) * 1); z-index: 500; }
        .hud-text { font-size: calc(var(--gu) * 2.2); }
        .hud-sub { font-size: calc(var(--gu) * 0.9); }
        .hud-icon { width: calc(var(--gu) * 3.5); height: auto; }

        /* --- ASSETS --- */
        .mad-bomber-img { position: absolute; top: 2%; z-index: 100; transform: translateX(-50%); }
        .bucket-stack { position: absolute; display: flex; flex-direction: column-reverse; align-items: center; z-index: 90; transform: translateX(-50%); bottom: 5%; will-change: left; }
        .bucket-img { object-fit: contain; width: 100%; height: 100%; }
        .bomb-img { position: absolute; z-index: 50; transform: translateX(-50%); }
        .explosion-img { position: absolute; z-index: 200; pointer-events: none; transform: translate(-50%, -50%); width: calc(var(--gu) * 15); }

        #toast {
            position: absolute;
            bottom: 5%; left: 50%;
            transform: translateX(-50%);
            background: rgba(239, 68, 68, 0.95);
            color: white;
            padding: calc(var(--gu) * 1) calc(var(--gu) * 2);
            border-radius: calc(var(--gu) * 0.5);
            font-size: calc(var(--gu) * 1.2);
            font-weight: bold;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .playing #game-area { cursor: none; }
    </style>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, onSnapshot, increment } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        const ASSETS_PATH = "https://kevindkeene.github.io/diner_dash/assets/";
        const THEME = {
            graphics: {
                BOMBER: ASSETS_PATH + 'bomber336x800.gif',
                FOOD_ITEMS: [
                    { file: '50s-fries.svg', value: 10 },
                    { file: '50s-shake.svg', value: 25 },
                    { file: '50s-burger.svg', value: 50 }
                ],
                BUCKET: ASSETS_PATH + 'bucket.gif', 
                BACKGROUND: ASSETS_PATH + 'kaboom-background.gif',
                SLIME: ASSETS_PATH + 'slimeball.gif',
                SPLASH: ASSETS_PATH + 'splash-screen.svg',
                EXPLOSION: ASSETS_PATH + 'explosion320x256.gif'
            }
        };

        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : { apiKey: "" };
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'catch-22-v2';
        let db, auth, userId = null, currentPlayer = null;

        if (firebaseConfig.apiKey) {
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            onAuthStateChanged(auth, async (user) => {
                if (user) { userId = user.uid; fetchLeaderboards(); } 
                else {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) await signInWithCustomToken(auth, __initial_auth_token);
                    else await signInAnonymously(auth);
                }
            });
        }

        let score = 0, lives = 3, level = 1, frame = 0, bombs = [];
        let bucketX = 50, targetX = 50, madBomberX = 50, madBomberDirection = 1, speedMultiplier = 1;
        let catchesThisLevel = 0, gunkTimeRemaining = 0, animationFrameHandle, allScores = [];
        
        let isGameOver = true, isCountdownActive = false, isMissSequence = false;
        let countdownTimer = 0, countdownValue = 5;

        async function fetchLeaderboards() {
            if (!db) return;
            const q = collection(db, 'artifacts', appId, 'public', 'data', 'scores');
            onSnapshot(q, (snapshot) => {
                allScores = [];
                snapshot.forEach(doc => allScores.push(doc.data()));
                if (isGameOver) updateLeaderboardUI();
            });
        }

        function updateLeaderboardUI() {
            const container = document.getElementById('daily-leaderboard');
            if (!container) return;
            const topOne = [...allScores].sort((a, b) => b.score - a.score).slice(0, 1);
            if (topOne.length === 0) {
                container.innerHTML = `<p class="opacity-40 italic text-center" style="font-size: calc(var(--gu)*1.2)">Waiting for the first Dasher...</p>`;
                return;
            }
            container.innerHTML = topOne.map((s) => `
                <div class="leaderboard-card mx-auto">
                    <div class="flex items-center">
                        <span class="lb-rank">#1</span>
                        <div class="text-left">
                            <p class="lb-name">${s.name || 'Dash'}</p>
                            <p class="lb-company">${s.company || '---'}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="lb-score">${s.score.toLocaleString()}</p>
                    </div>
                </div>
            `).join('');
        }

        async function saveScore() {
            if (!db || !userId || score === 0 || !currentPlayer) return;
            const scoreId = `${userId}_${Date.now()}`;
            const scoreDoc = doc(db, 'artifacts', appId, 'public', 'data', 'scores', scoreId);
            const playerDoc = doc(db, 'artifacts', appId, 'public', 'data', 'players', userId);
            try {
                await setDoc(scoreDoc, { userId, name: currentPlayer.name, company: currentPlayer.company, score, timestamp: Date.now() });
                await setDoc(playerDoc, { ...currentPlayer, bestScore: score > (currentPlayer.bestScore || 0) ? score : currentPlayer.bestScore, playCount: increment(1), lastPlayed: Date.now() }, { merge: true });
            } catch (e) { console.error("Save failed", e); }
        }

        function startGame() {
            if (!currentPlayer) { showRegistration(); return; }
            isGameOver = false; isCountdownActive = true; isMissSequence = false;
            countdownValue = 5; countdownTimer = performance.now();
            document.body.classList.add('playing');
            document.getElementById('hud').classList.remove('hidden');
            score = 0; lives = 3; frame = 0; level = 1; speedMultiplier = 1; catchesThisLevel = 0; 
            madBomberX = 50; bucketX = 50; targetX = 50; gunkTimeRemaining = 0;
            bombs.forEach(b => b.el.remove()); bombs = [];
            initGameElements();
            updateStats();
            const overlay = document.getElementById('overlay');
            overlay.classList.remove('hidden'); overlay.classList.remove('overlay-dark'); 
            document.getElementById('difficulty-buttons').innerHTML = ''; 
            cancelAnimationFrame(animationFrameHandle);
            gameLoop();
        }

        function showRegistration() {
            const overlay = document.getElementById('overlay');
            overlay.classList.remove('hidden'); overlay.classList.add('overlay-dark');
            document.getElementById('hud').classList.add('hidden');
            
            document.getElementById('status-message').innerHTML = `
                <div class="reg-container">
                    <h2 class="font-brand text-white italic leading-none text-center" style="font-size: calc(var(--gu)*5); margin-bottom: calc(var(--gu)*0.5)">PLAYER PROFILE</h2>
                    <p class="text-sm opacity-50 font-bold tracking-[0.3em] uppercase text-center" style="font-size: calc(var(--gu)*1.2); margin-bottom: calc(var(--gu)*1.5)">Register for the Leaderboard</p>
                    <div class="text-left">
                        <label class="reg-label">Full Name</label><input type="text" id="reg-name" class="form-input" placeholder="Enter name...">
                        <label class="reg-label">Company</label><input type="text" id="reg-company" class="form-input" placeholder="Enter company...">
                        <label class="reg-label">Work Email</label><input type="email" id="reg-email" class="form-input" placeholder="Enter email...">
                    </div>
                </div>
            `;
            const btns = document.getElementById('difficulty-buttons'); btns.innerHTML = '';
            const btn = document.createElement('button');
            btn.className = "btn-pill w-[85%] max-w-xl mx-auto";
            btn.textContent = "START DASH";
            btn.onclick = async (e) => {
                e.stopPropagation();
                const name = document.getElementById('reg-name').value.trim();
                const company = document.getElementById('reg-company').value.trim();
                const email = document.getElementById('reg-email').value.trim();
                if (!name || !company || !email) { showToast("Required fields empty!"); return; }
                currentPlayer = { name, company, email, playCount: 0, bestScore: 0 };
                startGame();
            };
            btns.appendChild(btn);
        }

        function initGameElements() {
            const area = document.getElementById('game-area');
            area.style.backgroundImage = `url('${THEME.graphics.BACKGROUND}')`;
            updateBucketVisuals();
            document.getElementById('mad-bomber-img').style.width = `8%`;
            document.getElementById('mad-bomber-img').innerHTML = `<img src="${THEME.graphics.BOMBER}" class="pixel-art w-full h-full">`;
            document.getElementById('life-icon').src = THEME.graphics.BUCKET;
        }

        function updateBucketVisuals() {
            const stack = document.getElementById('buckets-stack');
            stack.style.width = `8%`;
            stack.innerHTML = '';
            for (let i = 0; i < lives; i++) {
                const b = document.createElement('img');
                b.src = THEME.graphics.BUCKET; b.className = 'bucket-img pixel-art';
                b.style.height = `6%`; b.style.marginTop = `-1.5%`;
                stack.appendChild(b);
            }
        }

        function gameLoop() {
            if (isGameOver) return;
            frame++;

            // Smooth bucket physics
            const lerp = gunkTimeRemaining > 0 ? 0.08 : 0.4; 
            bucketX = bucketX + (targetX - bucketX) * lerp; 
            bucketX = Math.max(4, Math.min(bucketX, 96));
            document.getElementById('buckets-stack').style.left = `${bucketX}%`;

            if (isMissSequence) {
                if (frame % 12 === 0 && bombs.length > 0) {
                    const b = bombs.pop();
                    createExplosion(b.x, b.y);
                    b.el.remove();
                    triggerHaptic(100);
                }
                if (bombs.length === 0 && frame % 100 === 0) {
                    isMissSequence = false;
                    if (lives <= 0) endGame();
                    else {
                        isCountdownActive = true; countdownValue = 3; countdownTimer = performance.now();
                        document.getElementById('overlay').classList.remove('hidden');
                    }
                }
            } else if (isCountdownActive) {
                const now = performance.now();
                if (now - countdownTimer > 1000) { countdownTimer = now; countdownValue--; triggerHaptic(50); }
                const status = document.getElementById('status-message');
                if (countdownValue > 0) status.innerHTML = `<div class="road-stack"><p class="countdown-text animate-bounce">${countdownValue}</p></div>`;
                else if (countdownValue === 0) status.innerHTML = `<div class="road-stack"><p class="countdown-text animate-bounce">GO!</p></div>`;
                else { isCountdownActive = false; document.getElementById('overlay').classList.add('hidden'); }
            } else {
                if (gunkTimeRemaining > 0) { gunkTimeRemaining -= 16; document.getElementById('gunk-overlay').style.opacity = (gunkTimeRemaining / 3000) * 0.4; }
                updateBomber(); updateBombs();
            }
            animationFrameHandle = requestAnimationFrame(gameLoop);
        }

        function updateBomber() {
            const base = 1.0 * speedMultiplier;
            if (Math.random() < 0.04) madBomberDirection *= -1;
            madBomberX += madBomberDirection * base;
            if (madBomberX > 94) madBomberDirection = -1; else if (madBomberX < 6) madBomberDirection = 1;
            document.getElementById('mad-bomber-img').style.left = `${madBomberX}%`;
            const dropRate = Math.max(20, 80 - (level * 4));
            if (frame % Math.floor(dropRate) === 0) {
                if (Math.random() < 0.1) createBomb(madBomberX, 10, 'slime'); 
                else {
                    const rand = Math.random();
                    let food = rand < 0.2 ? THEME.graphics.FOOD_ITEMS[2] : (rand < 0.5 ? THEME.graphics.FOOD_ITEMS[1] : THEME.graphics.FOOD_ITEMS[0]);
                    createBomb(madBomberX, 10, 'good', food);
                }
            }
        }

        function createBomb(x, y, type, foodData = null) {
            const el = document.createElement('div');
            el.className = 'bomb-img absolute';
            el.style.width = `5%`; el.style.left = `${x}%`; el.style.top = `${y}%`;
            let imgSrc = type === 'slime' ? THEME.graphics.SLIME : (foodData ? ASSETS_PATH + foodData.file : ASSETS_PATH + THEME.graphics.FOOD_ITEMS[0].file);
            el.innerHTML = `<img src="${imgSrc}" class="w-full h-full object-contain">`;
            document.getElementById('game-area').appendChild(el);
            bombs.push({ x, y, el, type, value: (foodData ? foodData.value : 10), speed: 1.2 * speedMultiplier });
        }

        function updateBombs() {
            for (let i = bombs.length - 1; i >= 0; i--) {
                const b = bombs[i]; b.y += b.speed; b.el.style.top = `${b.y}%`;
                if (b.y > 78 && b.y < 86) { if (Math.abs(b.x - bucketX) < 8 / 1.5) handleCatch(i, b); } 
                else if (b.y > 95) { if (b.type === 'good') handleMiss(i, b); else { b.el.remove(); bombs.splice(i, 1); } }
            }
        }

        function handleCatch(idx, b) {
            if (b.type === 'slime') { gunkTimeRemaining = 3000; triggerHaptic(100); } 
            else {
                const points = b.value * level; score += points; catchesThisLevel++; triggerHaptic(20);
                showFloatingPoints(b.x, 82, `+${points}`);
                if (catchesThisLevel >= 15) nextLevel();
            }
            b.el.remove(); bombs.splice(idx, 1); updateStats();
        }

        function showFloatingPoints(x, y, text) {
            const el = document.createElement('div'); el.className = 'floating-points font-brand';
            el.style.left = `${x}%`; el.style.top = `${y}%`; el.textContent = text;
            document.getElementById('game-area').appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

        function handleMiss(idx, b) {
            if (isMissSequence) return;
            isMissSequence = true; triggerHaptic(300); lives--;
            updateBucketVisuals(); updateStats();
            createExplosion(b.x, 90);
            b.el.remove(); bombs.splice(idx, 1);
        }

        function createExplosion(x, y) {
            const ex = document.createElement('div');
            ex.className = 'explosion-img pixel-art';
            ex.style.left = `${x}%`; ex.style.top = `${y}%`;
            ex.innerHTML = `<img src="${THEME.graphics.EXPLOSION}" class="w-full">`;
            document.getElementById('game-area').appendChild(ex);
            setTimeout(() => ex.remove(), 800);
        }

        function nextLevel() {
            level++; catchesThisLevel = 0; speedMultiplier += 0.2;
            isCountdownActive = true; countdownValue = 3; countdownTimer = performance.now();
            document.getElementById('overlay').classList.remove('hidden');
        }

        function endGame() {
            isGameOver = true; isCountdownActive = false; isMissSequence = false;
            cancelAnimationFrame(animationFrameHandle);
            document.body.classList.remove('playing'); saveScore();
            
            const area = document.getElementById('game-area'); 
            area.style.backgroundImage = `url('${THEME.graphics.SPLASH}')`;
            document.getElementById('mad-bomber-img').innerHTML = '';
            document.getElementById('buckets-stack').innerHTML = '';
            document.getElementById('hud').classList.add('hidden'); 
            document.getElementById('gunk-overlay').style.opacity = 0;
            
            const overlay = document.getElementById('overlay');
            overlay.classList.remove('hidden'); overlay.classList.remove('overlay-dark'); 
            document.getElementById('status-message').innerHTML = `
                <div class="road-stack">
                    <p class="go-title">GAME OVER</p>
                    <p class="go-score">${score.toLocaleString()}</p>
                    <p class="go-sub">Final Score Recorded</p>
                </div>
            `;
            const btns = document.getElementById('difficulty-buttons'); btns.innerHTML = '';
            const btn = document.createElement('button'); btn.className = "btn-pill"; btn.textContent = "MAIN MENU"; 
            btn.onclick = (e) => { e.stopPropagation(); showInitialSplash(); }; 
            btns.appendChild(btn);
        }

        function showInitialSplash() {
            isGameOver = true; isCountdownActive = false; isMissSequence = false;
            document.body.classList.remove('playing'); 
            document.getElementById('hud').classList.add('hidden');
            document.getElementById('mad-bomber-img').innerHTML = ''; 
            document.getElementById('buckets-stack').innerHTML = '';
            bombs.forEach(b => b.el.remove()); bombs = [];
            const overlay = document.getElementById('overlay'); 
            overlay.classList.remove('hidden'); overlay.classList.remove('overlay-dark'); 
            const area = document.getElementById('game-area'); 
            area.style.backgroundImage = `url('${THEME.graphics.SPLASH}')`;
            document.getElementById('status-message').innerHTML = `
                <div class="road-stack">
                    <p class="expo-header">THE EXPO'S TOP DASHER</p>
                    <div id="daily-leaderboard" class="w-full flex justify-center"></div>
                </div>
            `;
            updateLeaderboardUI();
            const btns = document.getElementById('difficulty-buttons'); btns.innerHTML = '';
            const btn = document.createElement('button'); 
            btn.className = "btn-pill shadow-xl"; btn.textContent = "ENTER ARCADE";
            btn.onclick = (e) => { 
                e.stopPropagation(); toggleFullscreen();
                currentPlayer = null; 
                setTimeout(() => { showRegistration(); }, 100);
            };
            btns.appendChild(btn);
        }

        function showToast(msg) { const toast = document.getElementById('toast'); toast.textContent = msg; toast.style.opacity = '1'; setTimeout(() => { toast.style.opacity = '0'; }, 3000); }
        function triggerHaptic(ms) { if ("vibrate" in navigator) navigator.vibrate(ms); }
        function toggleFullscreen() { if (!document.fullscreenEnabled) return; if (!document.fullscreenElement) { document.documentElement.requestFullscreen().catch(e => {}); } }

        window.toggleFullscreen = toggleFullscreen;
        window.onload = () => {
            showInitialSplash();
            const area = document.getElementById('game-area');
            area.addEventListener('mousemove', handleInteraction);
            area.addEventListener('touchstart', (e) => { if (!isGameOver) { e.preventDefault(); handleInteraction(e); } }, { passive: false });
            area.addEventListener('touchmove', (e) => { if (!isGameOver) { e.preventDefault(); handleInteraction(e); } }, { passive: false });
        };

        function handleInteraction(e) {
            if (isGameOver) return; 
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const rect = document.getElementById('game-area').getBoundingClientRect();
            targetX = ((clientX - rect.left) / rect.width) * 100;
        }

        function updateStats() { 
            document.getElementById('score-display').textContent = score.toString().padStart(6, '0'); 
            document.getElementById('lives-count').textContent = `×${lives}`; 
            document.getElementById('level-display').textContent = `LVL ${level}`; 
        }
    </script>
</head>
<body>
    <div id="game-container">
        <div id="toast">Required fields empty!</div>
        <div id="hud" class="w-full bg-slate-950 border-b-4 border-slate-900 p-2 z-20 flex justify-between items-center hidden">
            <div class="flex flex-col text-left">
                <span class="hud-sub text-slate-500 font-black uppercase tracking-widest">Global Ranking System</span>
                <span id="score-display" class="hud-text font-mono font-black leading-none" style="color: #ffbf47">000000</span>
            </div>
            <div class="flex gap-12 items-center">
                <div class="flex flex-col items-center">
                    <span id="level-display" class="hud-sub font-black text-yellow-500 uppercase">Sector 01</span>
                    <div class="flex items-center gap-2 mt-1">
                        <img id="life-icon" src="" class="hud-icon object-contain pixel-art">
                        <span id="lives-count" class="hud-text text-white font-black">×3</span>
                    </div>
                </div>
            </div>
        </div>
        <div id="game-area">
            <div id="gunk-overlay" class="absolute top-0 left-0 w-full h-full bg-green-500 opacity-0 pointer-events-none z-150"></div>
            <div id="mad-bomber-img" class="mad-bomber-img"></div>
            <div id="buckets-stack" class="bucket-stack"></div>
            <div id="overlay" class="game-status-overlay">
                <div id="status-message" class="w-full flex flex-col items-center"></div>
                <div id="difficulty-buttons" class="w-full flex flex-col items-center justify-center"></div>
            </div>
        </div>
    </div>
</body>
</html>

